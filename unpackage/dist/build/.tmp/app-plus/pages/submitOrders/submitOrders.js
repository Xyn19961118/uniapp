(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/submitOrders/submitOrders"],{"5afb":function(e,t,i){"use strict";i.r(t);var n=i("f935"),s=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=s.a},6343:function(e,t,i){"use strict";i.r(t);var n=i("99a1"),s=i("5afb");for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);i("e1cb");var a=i("2877"),r=Object(a["a"])(s["default"],n["a"],n["b"],!1,null,"962c470c",null);t["default"]=r.exports},"8fb9":function(e,t,i){},"99a1":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},s=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s})},d0f0:function(e,t,i){"use strict";(function(e){i("3e9c"),i("921b");n(i("66fd"));var t=n(i("6343"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},e1cb:function(e,t,i){"use strict";var n=i("8fb9"),s=i.n(n);s.a},f935:function(e,t,i){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i("e1a2"),o=new s.OrderModel,a=function(){return i.e("components/common/select").then(i.bind(null,"547a"))},r=function(){return i.e("components/common/address").then(i.bind(null,"cfe6"))},c=function(){return i.e("components/submitOrders/content").then(i.bind(null,"27f6"))},u={components:{vSelect:a,vAddress:r,vContent:c},data:function(){return{isShowInvoice:!0,invoiceCurr:0,invoiceTextNo:"不开发票",invoiceTextYes:"开发票",invoiceType:0,invoiceName:"",invoiceTax:"",data:{},bonusVal:0,freightVal:0,orderPrice:0,bonusList:[],addressId:0,message:"",shopId:0}},onLoad:function(e){var t=e.id||"",i=e.shopid||0;this.shopId=i,this.id=t},onShow:function(t){var i=this;e.showLoading({title:"加载中",mask:!0});var n=this.id,s=this.shopId;o.checkHasAddr(function(t){1==t.error?e.showModal({title:"提示",content:t.errmsg,showCancel:!1,success:function(t){t.confirm&&e.navigateTo({url:"/pages/user/addAddress/addAddress?done=1&orderid=".concat(n,"&shopid=").concat(s)})}}):o.orderWaitPay(function(t){e.hideLoading();var s=t.address?t.address.address_id:0;i.data=t,i.orderPrice=t.info.totalPrice,i.addressId=0==n?s:n},n,s)})},methods:{messageInput:function(e){this.message=e.detail.value},changStatus:function(e){var t=e.currentTarget.dataset.index;this.checkBonus(e,t)},disabled:function(e){var t=e.currentTarget.dataset.index;this.checkBonus(e,t,!0)},checkBonus:function(e,t,i){var n=this.data,s=n.data,o=s[t].bonusList;if(1==e.type)var a=o.freight;else a=o.bonus;a.forEach(function(t){i?t.is_select=!1:(t.is_select=!1,t.user_sel_id==e.id&&(t.is_select=!0))}),this.data=n,this._recountData()},_recountData:function(){var e=this.data,t=this.orderPrice,i=0,n=0,s=[];e.data.forEach(function(e){var t=e.bonusList.freight,o=e.bonusList.bonus;t&&t.forEach(function(e){e.is_select&&(i+=parseFloat(e.type_money),s.push(e.user_sel_id))}),o&&o.forEach(function(e){e.is_select&&(n+=parseFloat(e.type_money),s.push(e.user_sel_id))})}),t=e.info.totalPrice-(i+n),this.orderPrice=t,this.freightVal=i,this.bonusVal=n,this.bonusList=s},editAddress:function(t){e.navigateTo({url:"/pages/user/address?param=callback"})},createData:function(){var e=this.bonusList,t=this.invoiceType,i=this.invoiceName,n=this.invoiceTax,s=this.message,o=this.addressId,a=this.shopId,r={invoice:t,invoice_input:i,postscript:s,invoice_ns:n,shop_bonus:e,address_id:o,shopid:a};return r},submitForm:function(){var t=this;e.showLoading({title:"提交中",mask:!0,success:function(i){o.orderPay(t.createData(),function(t){console.log(n("aa"," at pages\\submitOrders\\submitOrders.vue:351")),e.requestPayment({provider:"wxpay",orderInfo:t.id,success:function(e){console.log(n(e," at pages\\submitOrders\\submitOrders.vue:356")),console.log(n("bb"," at pages\\submitOrders\\submitOrders.vue:357"))},fail:function(e){console.log(n("fail:"+JSON.stringify(e)," at pages\\submitOrders\\submitOrders.vue:360"))}}),wx.hideLoading()})}})},getInvoiceIndex:function(e){var t=e.currentTarget.dataset.index;0==t&&(this.invoiceName="",this.invoiceTax=""),this.invoiceCurr=t},getInvoiceType:function(e){var t=e.currentTarget.dataset.index;this.invoiceType=t},handleInvoiceName:function(e){var t=e.detail.value;this.invoiceName=t},handleInvoiceTax:function(e){var t=e.detail.value;this.invoiceTax=t},showInvoice:function(e){this.isShowInvoice=!1},closeInvoice:function(){this.isShowInvoice=!0},submitInvoice:function(){var t=this.invoiceCurr,i=this.invoiceType,n=this.invoiceName,s=this.invoiceTax;if(1==t)switch(i=Number(i),i){case 0:if(""==n)return e.showToast({title:"请填写收票人抬头",icon:"none"}),!1;break;case 1:if(""==n)return e.showToast({title:"请填写收票人抬头",icon:"none"}),!1;if(""==s)return e.showToast({title:"请填写纳税人识别号",icon:"none"}),!1;break}this.isShowInvoice=!0}}};t.default=u}).call(this,i("6e42")["default"],i("0de9")["default"])}},[["d0f0","common/runtime","common/vendor"]]]);